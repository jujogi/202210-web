{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,sBCAAC,EAAAD,EAAA,uCDMA,MAAME,EAAiBC,SAASC,eAAe,YACzCC,EAAiBF,SAASC,eAAe,YACzCE,EAAcH,SAASC,eAAe,SAE5C,IAAIG,EACAC,EAAW,GACXC,EAAO,GAEXC,eAAeC,IACX,MAAMC,QCbVF,eAA2BG,GACvB,MAAMC,EAAgBb,EAAAc,WAAWF,EAAI,YACrC,IACI,MALRG,KAKgBA,SAAgBf,EAAAgB,QAAQH,GAOhC,OANiBE,EAAKE,KAAKC,IAChB,IACAA,EAAIC,OACPC,GAAIF,EAAIE,OAIlB,MAAMC,GACJC,QAAQC,IAAIF,IDCeG,CAAY1B,EAAAc,IAC3CX,EAAewB,UAAY,GAC3Bd,EAAiBe,SAAQC,IACrBC,EAAcD,MAGlBpB,EAAWI,EAGf,SAASiB,EAAcC,GACnB,MAAMF,EAAUzB,SAAS4B,cAAc,KACvCH,EAAQI,UAAY,UAEpBJ,EAAQK,aAAa,OAAQ,qBAAqBH,EAAKT,MAEvD,MAAMa,EAAaJ,EAAKK,OAASL,EAAKK,OAAO,GAAK,8EAI5CC,EAFuB3B,EAAK4B,MAAMC,GAAgBA,EAAYjB,KAAOS,EAAKT,KAGhF,mEAAkE,2DAGjEO,EAAOF,UAAY,mBACRQ,4GAEuBJ,EAAKS,oDACRT,EAAKU,iDACJC,EAAAC,eAAeZ,EAAKa,wBAC/CP,sBAINlC,EAAe0C,YAAYhB,GAE3B,MAAMiB,EAAoBjB,EAAQkB,cAAc,kBAEhDD,EAAkBE,iBAAiB,SAASrC,MAAOY,IAC/CA,EAAE0B,iBAEFvC,EAAKwC,KAAKnB,GACVW,EAAAS,iBAAiBzC,GAEbF,SACM4C,EAAAC,mBAAmBrD,EAAAc,GAAIN,EAAW8C,IAAK5C,GAGjDoC,EAAkBZ,aAAa,YAAY,GAC3CY,EAAkBS,UAAY,sBAKtC,SAASC,IACL,MAAMC,EAAcnD,EAAeoD,MAC7BC,EAAWpD,EAAYmD,MAE7B,IAAIE,EAAmB,GAGnBA,EADgB,KAAhBH,EACmBhD,EAASoD,QAAQhC,GAAYA,EAAQW,WAAaiB,IAElDhD,EAGN,QAAbkD,IACAC,EAAmBA,EAAiBE,MAAK,CAACC,EAAGC,IAAMA,EAAEpB,MAAQmB,EAAEnB,SAGlD,SAAbe,IACAC,EAAmBA,EAAiBE,MAAK,CAACC,EAAGC,IAAMD,EAAEnB,MAAQoB,EAAEpB,SAGnEzC,EAAewB,UAAY,GAC3BiC,EAAiBhC,SAAQC,IACrBC,EAAcD,MAKtBvB,EAAe0C,iBAAiB,UAAUzB,IACtCiC,OAGJjD,EAAYyC,iBAAiB,UAAUzB,IACnCiC,OAGJS,EAAAC,mBAAmBlE,EAAAmE,MAAMxD,MAAOyD,IACxBA,GAGF5D,EAAa4D,EACb1D,QAAa0C,EAAAiB,gBAAgBrE,EAAAc,GAAIN,EAAW8C,MAG1C5C,EAAOgC,EAAA4B,iBAKX1D","sources":["src/scripts/shop.js","src/scripts/functions/products.js"],"sourcesContent":["import { db, auth } from \"./app\";\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { getProducts } from \"./functions/products\";\nimport { createFirebaseCart, getFirebaseCart  } from \"./functions/cart\";\nimport { addProductToCart, getMyLocalCart, currencyFormat } from \"../utils\";\n\nconst productSection = document.getElementById(\"products\");\nconst categoryFilter = document.getElementById(\"category\");\nconst orderFilter = document.getElementById(\"order\");\n\nlet userLogged = undefined;\nlet products = [];\nlet cart = [];\n\nasync function loadProducts() {\n    const firebaseProducts = await getProducts(db);\n    productSection.innerHTML = \"\";\n    firebaseProducts.forEach(product => {\n        renderProduct(product);\n    });\n\n    products = firebaseProducts;\n}\n\nfunction renderProduct(item) {\n    const product = document.createElement(\"a\");\n    product.className = \"product\";\n\n    product.setAttribute(\"href\", `./product.html?id=${item.id}`);\n\n    const coverImage = item.images ? item.images[0] : \"https://cdn1.iconfinder.com/data/icons/business-company-1/500/image-512.png\";\n\n    const isProductAddedToCart = cart.some((productCart) => productCart.id === item.id);\n\n    const productButtonCart = isProductAddedToCart ?\n    '<button class=\"product__cart\" disabled>Producto añadido</button>' :\n    '<button class=\"product__cart\">Añadir al carrito</button>';\n\n    product.innerHTML = `\n    <img src=\"${coverImage}\" alt=\"\" class=\"product__image\">\n    <div class=\"product__info\">\n        <p class=\"product__category\">${item.category}</p> \n        <h2 class=\"product__name\">${item.name}</h2>\n        <h3 class=\"product__price\">${currencyFormat(item.price)}</h3>\n        ${productButtonCart}\n    </div>\n    `;\n\n    productSection.appendChild(product);\n\n    const productCartButton = product.querySelector(\".product__cart\");\n\n    productCartButton.addEventListener(\"click\", async (e) => {\n        e.preventDefault(); // evitar que al dar click en el boton, funcione el enlace del padre.\n\n        cart.push(item);\n        addProductToCart(cart);\n\n        if (userLogged) {\n            await createFirebaseCart(db, userLogged.uid, cart);\n        }\n\n        productCartButton.setAttribute(\"disabled\", true);\n        productCartButton.innerText = \"Producto añadido\";\n\n    });\n}\n\nfunction filterBy(){\n    const newCategory = categoryFilter.value;\n    const newOrder = orderFilter.value;\n\n    let filteredProducts = [];\n\n    if (newCategory !== \"\") {\n        filteredProducts = products.filter((product) => product.category === newCategory);\n    } else {\n        filteredProducts = products;\n    }\n\n    if (newOrder === \"asc\") {\n        filteredProducts = filteredProducts.sort((a, b) => b.price - a.price);\n    }\n\n    if (newOrder === \"desc\") {\n        filteredProducts = filteredProducts.sort((a, b) => a.price - b.price);\n    }\n    \n    productSection.innerHTML = \"\";\n    filteredProducts.forEach(product => {\n        renderProduct(product);\n    });\n\n}\n\ncategoryFilter.addEventListener(\"change\", e => {\n    filterBy();\n});\n\norderFilter.addEventListener(\"change\", e => {\n    filterBy();\n});\n\nonAuthStateChanged(auth, async (user) => {\n    if (user) {\n      // User is signed in, see docs for a list of available properties\n      // https://firebase.google.com/docs/reference/js/firebase.User\n      userLogged = user;\n      cart = await getFirebaseCart(db, userLogged.uid);\n      // ...\n    } else {\n        cart = getMyLocalCart();\n      // User is signed out\n      // ...\n    }\n\n    loadProducts();\n\n  });\n","import { collection, getDocs } from \"firebase/firestore\";\n\nasync function getProducts(db) {\n    const collectionRef = collection(db, \"products\");\n    try {\n        const { docs } =  await getDocs(collectionRef);\n        const products = docs.map((doc) => {\n            return {\n                ...doc.data(),\n                id: doc.id,\n            };\n        });\n        return products;\n    } catch(e) {\n        console.log(e);\n    }\n}\n\nexport {\n    getProducts,\n}"],"names":["$li1Mx","parcelRequire","$etBjH","$a9cddcee321f50ec$var$productSection","document","getElementById","$a9cddcee321f50ec$var$categoryFilter","$a9cddcee321f50ec$var$orderFilter","$a9cddcee321f50ec$var$userLogged","$a9cddcee321f50ec$var$products","$a9cddcee321f50ec$var$cart","async","$a9cddcee321f50ec$var$loadProducts","firebaseProducts","db","collectionRef","collection","docs","getDocs","map","doc","data","id","e","console","log","$3f21a7ce0033bb95$export$68a801b7b3c0bfaa","innerHTML","forEach","product","$a9cddcee321f50ec$var$renderProduct","item","createElement","className","setAttribute","coverImage","images","productButtonCart","some","productCart","category","name","$2EF88","currencyFormat","price","appendChild","productCartButton","querySelector","addEventListener","preventDefault","push","addProductToCart","$hMt9z","createFirebaseCart","uid","innerText","$a9cddcee321f50ec$var$filterBy","newCategory","value","newOrder","filteredProducts","filter","sort","a","b","$1tHc5","onAuthStateChanged","auth","user","getFirebaseCart","getMyLocalCart"],"version":3,"file":"shop.7855240a.js.map"}