{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,yBCAAD,EAAAC,EAAA,mDDMA,MAAMC,EAAqBC,SAASC,eAAe,eAC7CC,EAAuBF,SAASC,eAAe,iBAErD,IAAIE,EACAC,EAAO,GASXC,eAAeC,IACX,MAAMC,EARV,SAAkBC,GACd,MAAMC,EAAMC,OAAOC,SAASC,OAG5B,OAFqB,IAAIC,gBAAgBJ,GACVK,IAAIN,GAKjBO,CAAS,OAY/B,SAAuBC,GACnBd,EAAqBe,UAAY,6DACqBD,EAAQE,OAAO,OAErE,MAEMC,EAFuBf,EAAKgB,MAAMC,GAAgBA,EAAYC,KAAON,EAAQM,KAGnF,mEAAkE,2DAGjEvB,EAAkBkB,UAAY,mCACHD,EAAQO,kDACFP,EAAQQ,mDACbC,EAAAC,eAAeV,EAAQW,oBAClDR,IAEEH,EAAQE,OAAOU,OAAS,GAmBhC,SAAuBV,GACnB,MAAMW,EAAY7B,SAASC,eAAe,aAEpC6B,EAAU9B,SAAS+B,cAAc,OACvCD,EAAQE,UAAY,mBAEpBd,EAAOe,SAAQC,IACXJ,EAAQb,WAAa,aAAaiB,SAGtChC,EAAqBiC,YAAYL,GAEX9B,SAASoC,cAAc,qBAE/BC,iBAAiB,SAASC,IACX,QAArBA,EAAEC,OAAOC,SACTX,EAAUY,aAAa,MAAOH,EAAEC,OAAOG,eAlC3CC,CAAc3B,EAAQE,QAG1B,MAAM0B,EAAoB5C,SAASoC,cAAc,kBACjDQ,EAAkBP,iBAAiB,SAASC,IACxClC,EAAKyC,KAAK7B,GAEVS,EAAAqB,iBAAiB1C,GAEbD,GACA4C,EAAAC,mBAAmBnD,EAAAoD,GAAI9C,EAAW+C,IAAK9C,GAG3CwC,EAAkBH,aAAa,YAAY,GAC3CG,EAAkBO,UAAY,sBAlClCC,CALgB,UCrBpB/C,eAA0BiB,GACtB,MAAM+B,EAASC,EAAAC,IAAI1D,EAAAoD,GAAI,WAAY3B,GACnC,IAII,aAHsBgC,EAAAE,OAAOH,IACRI,OAGvB,MAAMnB,GACJoB,QAAQC,IAAIrB,IDWGsB,CAAWrD,GAI1Be,GAAIf,IA8DZsD,EAAAC,mBAAmBjE,EAAAkE,MAAM1D,MAAO2D,IACxBA,GAGF7D,EAAa6D,EACb5D,QAAa2C,EAAAkB,gBAAgBpE,EAAAoD,GAAI9C,EAAW+C,KAC5CQ,QAAQC,IAAIvD,IAGVA,EAAOqB,EAAAyC,iBAKX5D","sources":["src/scripts/product.js","src/scripts/functions/getProduct.js"],"sourcesContent":["import { db, auth } from \"./app\";\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { getProduct } from \"./functions/getProduct\";\nimport { getFirebaseCart, createFirebaseCart } from \"./functions/cart\";\nimport { getMyLocalCart, addProductToCart, currencyFormat } from \"../utils\";\n\nconst productInfoSection = document.getElementById(\"productInfo\");\nconst productAssetsSection = document.getElementById(\"productAssets\");\n\nlet userLogged = undefined;\nlet cart = [];\n\nfunction getParam(param) {\n    const url = window.location.search;\n    const searchParams = new URLSearchParams(url);\n    const productId = searchParams.get(param);\n    return productId;\n}\n\nasync function loadProduct() {\n    const productId = getParam(\"id\"); // http://localhost:1234/product.html?id=TXQ9Wf1GIoAOJLkIEMYo&age=20\n\n    const data = await getProduct(productId);\n\n    const product = {\n        ...data,\n        id: productId, // docSnap.id,\n    }\n\n    renderProduct(product);\n}\n\nfunction renderProduct(product) {\n    productAssetsSection.innerHTML = `\n    <img class=\"product__mainImage\" id=\"mainImage\" src=\"${product.images[0]}\">`;\n\n    const isProductAddedToCart = cart.some((productCart) => productCart.id === product.id);\n\n    const productButtonCart = isProductAddedToCart ?\n    '<button class=\"product__cart\" disabled>Producto añadido</button>' :\n    '<button class=\"product__cart\">Añadir al carrito</button>';\n\n    productInfoSection.innerHTML = `\n    <h1 class=\"product__name\">${product.name}</h1>\n    <p class=\"product__description\">${product.description}</p>\n    <h3 class=\"product__price\">${currencyFormat(product.price)}</h3>\n    ${productButtonCart}`;\n\n    if (product.images.length > 1) {\n        createGallery(product.images);\n    }\n\n    const productCartButton = document.querySelector(\".product__cart\");\n    productCartButton.addEventListener(\"click\", e => {\n        cart.push(product);\n\n        addProductToCart(cart);\n\n        if (userLogged) {\n            createFirebaseCart(db, userLogged.uid, cart);\n        }\n\n        productCartButton.setAttribute(\"disabled\", true);\n        productCartButton.innerText = \"Producto añadido\";\n    });\n}\n\nfunction createGallery(images) {\n    const mainImage = document.getElementById(\"mainImage\");\n\n    const gallery = document.createElement(\"div\");\n    gallery.className = \"product__gallery\";\n\n    images.forEach(image => {\n        gallery.innerHTML += `<img src=\"${image}\">`;\n    });\n\n    productAssetsSection.appendChild(gallery);\n\n    const galleryImages = document.querySelector(\".product__gallery\");\n\n    galleryImages.addEventListener(\"click\", e => {\n        if (e.target.tagName === \"IMG\") {\n            mainImage.setAttribute(\"src\", e.target.currentSrc);\n        }\n    });\n}\n\nonAuthStateChanged(auth, async (user) => {\n    if (user) {\n      // User is signed in, see docs for a list of available properties\n      // https://firebase.google.com/docs/reference/js/firebase.User\n      userLogged = user;\n      cart = await getFirebaseCart(db, userLogged.uid);\n      console.log(cart);\n      // ...\n    } else {\n        cart = getMyLocalCart();\n      // User is signed out\n      // ...\n    }\n\n    loadProduct();\n\n  });","import { db } from \"../app\";\nimport { doc, getDoc } from \"firebase/firestore\";\n\nasync function getProduct(id) {\n    const docRef = doc(db, \"products\", id);\n    try {\n        const docSnap = await getDoc(docRef);\n        const data = docSnap.data();\n    \n        return data; \n    } catch(e) {\n        console.log(e);\n    }\n}\n\nexport {\n    getProduct\n}"],"names":["$li1Mx","parcelRequire","$63445bb05f51f6f7$var$productInfoSection","document","getElementById","$63445bb05f51f6f7$var$productAssetsSection","$63445bb05f51f6f7$var$userLogged","$63445bb05f51f6f7$var$cart","async","$63445bb05f51f6f7$var$loadProduct","productId","param","url","window","location","search","URLSearchParams","get","$63445bb05f51f6f7$var$getParam","product","innerHTML","images","productButtonCart","some","productCart","id","name","description","$2EF88","currencyFormat","price","length","mainImage","gallery","createElement","className","forEach","image","appendChild","querySelector","addEventListener","e","target","tagName","setAttribute","currentSrc","$63445bb05f51f6f7$var$createGallery","productCartButton","push","addProductToCart","$hMt9z","createFirebaseCart","db","uid","innerText","$63445bb05f51f6f7$var$renderProduct","docRef","$etBjH","doc","getDoc","data","console","log","$96d763eed7c24a29$export$e2005c9600188ac7","$1tHc5","onAuthStateChanged","auth","user","getFirebaseCart","getMyLocalCart"],"version":3,"file":"product.cc70c22b.js.map"}